/*! jqm-multislider (C)Armin Junge 13-05-2018 */

$.widget("vertumnus.multislider",{options:{min:0,max:100,step:1,showValue:!0},_create:function(){let e=this.element.attr("min"),t=this.element.attr("max"),i=this.element.attr("step"),s=this.element.attr("data-show-value");void 0!==e&&(this.options.min=parseInt(e)),void 0!==t&&(this.options.max=parseInt(t)),void 0!==i&&(this.options.step=parseInt(i)),void 0!==s&&(this.options.showValue="true"===s),this.element.addClass("ui-rangeslider"),this._label=this.element.find("label").first().insertBefore(this.element),this._sliderContainer=$('<div class="ui-rangeslider-sliders" />').prependTo(this.element),this._sliders=[];let n=this;this.element.find("input").each(function(e){n._newSlider($(this),e)}).change({widget:this},this._change).parent().hide(),this._initSliders()},_setOption:function(e,t){switch(e){case"showValue":if("boolean"!=typeof t)return!1;this._showValue(t)}this._super(e,t)},_change:function(e){my=e.data.widget;let t=$(e.target),i=parseInt(t.attr("pos")),s=parseInt(i>0?my._sliders[i-1].slider.val():my.options.min),n=parseInt(i<my._sliders.length-1?my._sliders[i+1].slider.val():my.options.max+1),l=parseInt(t.val());l<=s&&t.val(s+my.options.step).slider("refresh"),l>=n&&t.val(n-my.options.step).slider("refresh"),my.options.showValue&&my._sliderContainer.find(`a[pos=${i}]`).html(t.val()),my._trigger("change",e)},_newSlider:function(e,t){let i=e.attr({min:this.options.min,max:this.options.max,step:this.options.step,"data-show-value":this.options.showValue,pos:t}).slider(),s=$.data(i[0],"mobile-slider");return s.slider.appendTo(this._sliderContainer),s.handle.attr({pos:t}),this._sliders.push({slider:i,handle:s.handle}),i},_initSliders:function(){let e=(this.options.max-this.options.min)/(this._sliders.length+1),t=parseInt(this.options.min);this._sliders.forEach(function(i){i.slider.val(Math.round(t+=e)).slider("refresh"),this.options.showValue&&i.handle.html(i.slider.val())},this)},_showValue:function(e){this._sliders.forEach(function(t){t.handle.html(e?t.slider.val():"")})},values:function(){return this._sliders.map(e=>parseInt(e.slider.val()))},value:function(e,t){return e<0||e>=this._sliders.length?null:void 0===t?parseInt(this._sliders[e].slider.val()):(this._sliders[e].slider.val(t).change(),this)},count:function(e){if(void 0===e)return this._sliders.length;let t=this._sliders.length;if(e<this._sliders.length)for(;t>e;--t)this.decrease();else for(;t<e;++t)this.increase();return this},increase:function(){this._newSlider($('<input type="range" />').appendTo(this.element),this._sliders.length).change({widget:this},this._change).parent().hide(),this._initSliders(),this._trigger("change")},decrease:function(){this._sliders.pop(),this.element.find(".ui-slider-track:last").remove(),this.element.find("input:last").slider("destroy").remove(),this._initSliders(),this._trigger("change")}});